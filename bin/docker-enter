#!/bin/bash

CONTAINER_NAME=$1

# Check if a container name is provided
if [ -z "$CONTAINER_NAME" ]; then
    echo "Usage: $0 <container_name>"
    exit 1
fi

# Fetch the container ID and its status
CONTAINER_ID=$(docker ps -aq -f ancestor=$CONTAINER_NAME)

# If no container was found, try searching by ID
if [ -z "$CONTAINER_ID" ]; then
    CONTAINER_ID=$(docker ps -aq -f id=$CONTAINER_NAME)
fi

CONTAINER_STATUS=$(docker inspect --format '{{.State.Running}}' $CONTAINER_ID 2>/dev/null)

# Check if the container exists and is running
if [ -z "$CONTAINER_ID" ] || [ "$CONTAINER_STATUS" != "true" ]; then
    echo "Container $CONTAINER_NAME not found or not running."
    exit 1
fi

# Try to execute /bin/bash inside the container
if docker exec -it $CONTAINER_ID /bin/bash; then
    exit 0
fi

# If /bin/bash does not exist, execute /bin/sh
docker exec -it $CONTAINER_ID /bin/sh